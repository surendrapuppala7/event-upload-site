<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guest Upload â€¢ Kachow</title>
  <meta name="description" content="Upload photos and videos to your Kachow event." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --bg: #fff7f1;
      --ink: #1b1b1f;
      --muted: #5c5d69;
      --brand: #ff6b6b;
      --brand-2: #5bc0eb;
      --brand-3: #ffd166;
      --brand-4: #9b5de5;
      --card: #ffffff;
      --line: #f0e5dc;
      --shadow: 0 20px 60px rgba(22, 20, 32, 0.12);
      --shadow-soft: 0 12px 30px rgba(22, 20, 32, 0.08);
      --radius-lg: 28px;
      --radius-md: 18px;
      --radius-sm: 12px;
      --ease: cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Nunito", system-ui, -apple-system, Segoe UI, sans-serif;
      color: var(--ink);
      background: var(--bg);
      line-height: 1.6;
    }

    .page {
      min-height: 100vh;
      background:
        radial-gradient(700px 420px at 5% 10%, rgba(255, 209, 102, 0.35), transparent 60%),
        radial-gradient(640px 420px at 90% 5%, rgba(91, 192, 235, 0.35), transparent 55%),
        radial-gradient(540px 380px at 20% 90%, rgba(155, 93, 229, 0.18), transparent 60%),
        linear-gradient(180deg, #fff7f1 0%, #fff1e4 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .card {
      background: #fff;
      border-radius: var(--radius-lg);
      padding: 28px;
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      max-width: 520px;
      width: 100%;
      text-align: center;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      letter-spacing: 0.3px;
      margin-bottom: 12px;
      text-decoration: none;
      color: var(--ink);
    }

    .logo-mark {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 56px;
      height: 44px;
    }

    .logo-mark svg {
      width: 56px;
      height: 44px;
    }

    .logo-text {
      font-family: "Fraunces", serif;
      font-size: 1.1rem;
      letter-spacing: 0.08em;
    }

    .home-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 6px;
      color: var(--muted);
      font-weight: 700;
      text-decoration: none;
      font-size: 0.88rem;
    }

    .home-link:hover {
      color: var(--ink);
    }

    h1 {
      font-family: "Fraunces", serif;
      font-size: clamp(1.8rem, 3vw, 2.4rem);
      margin: 0 0 8px;
    }

    .subhead {
      color: var(--muted);
      margin: 0 0 18px;
    }

    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 22px;
      border-radius: 999px;
      border: 0;
      background: linear-gradient(135deg, var(--brand), #ff8f8f);
      color: #fff;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 12px 26px rgba(22, 20, 32, 0.18);
      transition: transform 0.25s var(--ease), box-shadow 0.25s var(--ease);
    }

    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 30px rgba(22, 20, 32, 0.22);
    }

    .status {
      margin-top: 16px;
      font-weight: 600;
    }

    .spinner {
      margin-top: 14px;
      display: none;
      text-align: center;
      color: var(--muted);
    }

    .spinner .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--brand-2);
      display: inline-block;
      animation: bounce 0.8s infinite ease-in-out;
    }

    .spinner .dot:nth-child(2) { animation-delay: 0.15s; }
    .spinner .dot:nth-child(3) { animation-delay: 0.3s; }

    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0.6); opacity: 0.6; }
      40% { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="card">
      <a class="logo" href="index.html">
        <span class="logo-mark">
          <svg viewBox="0 0 160 120" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g stroke="#203040" stroke-width="4" stroke-linejoin="round" stroke-linecap="round">
              <path d="M46 30h78c8 0 14 6 14 14v30c0 8-6 14-14 14H46c-8 0-14-6-14-14V44c0-8 6-14 14-14z" fill="#E65047"/>
              <path d="M32 64h106v18c0 8-6 14-14 14H46c-8 0-14-6-14-14V64z" fill="#68B7B1"/>
              <path d="M108 20h28c6 0 10 4 10 10v14c0 6-4 10-10 10h-28z" fill="#E65047"/>
              <rect x="112" y="26" width="20" height="16" rx="4" fill="#FFF6E6"/>
              <circle cx="122" cy="34" r="4" fill="#203040"/>
              <circle cx="70" cy="70" r="30" fill="#203040"/>
              <circle cx="70" cy="70" r="23" fill="#FFF6E6"/>
              <circle cx="70" cy="70" r="14" fill="#2F4A5A"/>
              <circle cx="64" cy="64" r="4" fill="#FFF6E6"/>
              <path d="M104 70l8-8 8 8-8 8-8-8z" fill="#FFF6E6"/>
              <circle cx="114" cy="80" r="3" fill="#FFF6E6"/>
              <path d="M104 86h16" stroke="#FFF6E6" stroke-width="4"/>
            </g>
          </svg>
        </span>
        <span class="logo-text">KACHOW</span>
      </a>
      <a class="home-link" href="index.html">Back to home</a>
      <h1 id="eventName">Upload to event</h1>
      <p id="eventMessage" class="subhead">Take a photo or record a video to upload.</p>
      <button id="btn" class="button">ðŸ“¸ Take Photo / ðŸŽ¥ Record Video</button>
      <p id="status" class="status"></p>
      <div id="spinner" class="spinner">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div style="margin-top: 8px; font-size: 0.9rem;">Uploading...</div>
      </div>
    </div>
  </div>

<script>
const params = new URLSearchParams(location.search);
const eventId = params.get("eventId");
const API_BASE = "https://event-upload-api.surendra-david-puppala.workers.dev";

if (!eventId) {
  document.getElementById("eventName").innerText = "Invalid event link";
  document.getElementById("eventMessage").innerText = "Please check your QR link and try again.";
} else {
  document.getElementById("eventName").innerText = "Upload to Event: " + eventId;
  document.getElementById("eventMessage").innerText =
    "Take a photo or record a video to upload.";
}

async function uploadFile(file) {
  const status = document.getElementById("status");
  const spinner = document.getElementById("spinner");

  if (!file) {
    status.textContent = "âš ï¸ No file selected.";
    return;
  }

  if (!eventId) {
    status.textContent = "âŒ Missing event ID.";
    return;
  }

  spinner.style.display = "block";
  status.textContent = "";

  const form = new FormData();
  form.append("file", file);
  form.append("eventId", eventId);

  try {
    const res = await fetch(`${API_BASE}/`, {
      method: "POST",
      body: form
    });

    spinner.style.display = "none";

    if (res.ok) {
      status.textContent = "âœ… Uploaded successfully! Thank you!";
      status.style.color = "#0d6e52";
    } else {
      status.textContent = "âŒ Upload failed. Please try again.";
      status.style.color = "#b42318";
    }
  } catch (error) {
    console.error(error);
    spinner.style.display = "none";
    status.textContent = "âŒ Network error. Please try again.";
    status.style.color = "#b42318";
  }
}

document.getElementById("btn").onclick = () => {
  const input = document.createElement("input");
  input.type = "file";
  input.accept = "image/*,video/*";
  input.capture = "environment";
  input.onchange = () => uploadFile(input.files[0]);
  input.click();
};
</script>
</body>
</html>
